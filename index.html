<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ú–µ–Ω—é –ø–∏—Ü—Ü</title>
  <style>
    body { font-family: system-ui, sans-serif; background:#fffaf0; color:#222; margin:0; padding:20px; }
    h1 { text-align:center; }
    .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:16px; margin-top:20px; }
    .card { background:#fff; border-radius:12px; padding:16px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
    .card h3 { margin:0 0 8px 0; }
    .card p { color:#555; margin:0 0 10px 0; }
    .btn { display:inline-block; background:#28a745; color:#fff; border:none; border-radius:8px;
           padding:10px 14px; cursor:pointer; font-size:15px; }
    .note { margin-top:16px; text-align:center; color:#666; font-size:14px; }
    #status { text-align:center; margin-bottom:10px; font-weight:bold; }
  </style>
</head>
<body>
  <h1>üçï –ú–µ–Ω—é –ø–∏—Ü—Ü</h1>
  <div id="status">üî¥ –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Telegram</div>
  <div class="grid" id="menu"></div>
  <div class="note">–û–ø–ª–∞—Ç–∞ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Telegram.</div>

  <script>
    const PIZZAS = [
      { id: "margherita", name: "Margherita", desc: "–¢–æ–º–∞—Ç–Ω—ã–π —Å–æ—É—Å, –º–æ—Ü–∞—Ä–µ–ª–ª–∞, –±–∞–∑–∏–ª–∏–∫", price_rub: 450 },
      { id: "pepperoni", name: "Pepperoni", desc: "–ü–µ–ø–ø–µ—Ä–æ–Ω–∏, –º–æ—Ü–∞—Ä–µ–ª–ª–∞, —Ç–æ–º–∞—Ç—ã", price_rub: 550 },
      { id: "four_cheese", name: "Four Cheese", desc: "4 —Å—ã—Ä–∞, —Å–ª–∏–≤–æ—á–Ω—ã–π —Å–æ—É—Å", price_rub: 650 },
      { id: "veggie", name: "Veggie", desc: "–û–≤–æ—â–∏ –≥—Ä–∏–ª—å, –º–æ—Ü–∞—Ä–µ–ª–ª–∞, —Ç–æ–º–∞—Ç–Ω—ã–π —Å–æ—É—Å", price_rub: 500 },
    ];

    function isInTelegram() {
      return typeof window.Telegram !== "undefined" && window.Telegram.WebApp;
    }

    function updateStatus() {
      const s = document.getElementById("status");
      if (isInTelegram()) {
        s.textContent = "üü¢ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ Telegram WebApp";
        s.style.color = "green";
        window.Telegram.WebApp.expand();
      } else {
        s.textContent = "üî¥ –û—Ç–∫—Ä—ã—Ç–æ –≤–Ω–µ Telegram (–¥–µ–º–æ-—Ä–µ–∂–∏–º)";
        s.style.color = "red";
      }
    }

    function renderMenu() {
      const menu = document.getElementById("menu");
      menu.innerHTML = "";
      PIZZAS.forEach(p => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <h3>${p.name} ‚Äî ${p.price_rub}‚ÇΩ</h3>
          <p>${p.desc}</p>
          <button class="btn" data-id="${p.id}">–ö—É–ø–∏—Ç—å</button>
        `;
        menu.appendChild(card);
      });
    }

    document.addEventListener("click", e => {
      const btn = e.target.closest(".btn");
      if (!btn) return;
      const pizza = PIZZAS.find(p => p.id === btn.dataset.id);
      if (!pizza) return;

      const data = { pizza_id: pizza.id, name: pizza.name, price_rub: pizza.price_rub };

      if (isInTelegram()) {
        window.Telegram.WebApp.sendData(JSON.stringify(data));
        window.Telegram.WebApp.showAlert(`–ó–∞–ø—Ä–æ—Å –æ–ø–ª–∞—Ç—ã: ${pizza.name} (${pizza.price_rub}‚ÇΩ)`);
      } else {
        alert("‚ö†Ô∏è –≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ Telegram.\n–û—Ç–∫—Ä–æ–π –µ—ë —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –±–æ—Ç–∞ /start.");
      }
    });

    updateStatus();
    renderMenu();
  </script>
</body>
</html>
